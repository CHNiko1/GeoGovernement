{% extends "base.html" %}

{% block title %}{{ article.title }} - News - Georgian Government{% endblock %}

{% block breadcrumb %}
<li><a href="{{ url_for('news') }}">News</a></li>
<li>{{ article.title }}</li>
{% endblock %}

{% block content %}
<section class="section article-detail">
    <div class="container">
        <article class="article-full">
            <header class="article-header">
                <h1>{{ article.title }}</h1>
                <div class="article-meta">
                    <time datetime="{{ article.date }}">{{ article.date|date_format }}</time>
                    <span class="article-category">{{ article.categories[0] }}</span>
                </div>
            </header>

            <div class="article-content">
                <div class="article-image">{{ article.image }}</div>
                <div class="article-body">
                    {{ article.content }}
                </div>

                <div class="article-tags">
                    <h3>Topics</h3>
                    <div class="tag-list">
                        {% for category in article.categories %}
                        <a href="{{ url_for('news', category=category) }}" class="tag">{{ category }}</a>
                        {% endfor %}
                    </div>
                </div>
            </div>

            <footer class="article-footer">
                <div class="article-share">
                    <p>Share this article:</p>
                    <div class="share-buttons">
                        <button onclick="shareArticle('twitter')" class="share-btn">Twitter</button>
                        <button onclick="shareArticle('facebook')" class="share-btn">Facebook</button>
                        <button onclick="shareArticle('email')" class="share-btn">Email</button>
                        <button onclick="copyLink()" class="share-btn">Copy Link</button>
                    </div>
                </div>
            </footer>
        </article>

        <!-- Related News -->
        {% if related_news %}
        <section class="related-news">
            <h2>Related News</h2>
            <div class="related-news-grid">
                {% for news_item in related_news %}
                <a href="{{ url_for('news_detail', slug=news_item.title|slugify) }}" class="related-news-card">
                    <div class="related-news-image">{{ news_item.image }}</div>
                    <h3>{{ news_item.title }}</h3>
                    <p>{{ news_item.excerpt }}</p>
                    <time>{{ news_item.date|date_format }}</time>
                </a>
                {% endfor %}
            </div>
        </section>
        {% endif %}

        <nav class="article-nav">
            <a href="{{ url_for('news') }}" class="btn btn-secondary">‚Üê Back to News</a>
            <a href="{{ url_for('home') }}" class="btn btn-secondary">Home</a>
        </nav>
    </div>
</section>

{% endblock %}

{% block scripts %}
<script>
function shareArticle(platform) {
    const title = document.querySelector('.article-header h1').textContent;
    const url = window.location.href;
    
    let shareUrl;
    switch(platform) {
        case 'twitter':
            shareUrl = `https://twitter.com/intent/tweet?text=${encodeURIComponent(title)}&url=${encodeURIComponent(url)}`;
            break;
        case 'facebook':
            shareUrl = `https://www.facebook.com/sharer/sharer.php?u=${encodeURIComponent(url)}`;
            break;
        case 'email':
            shareUrl = `mailto:?subject=${encodeURIComponent(title)}&body=${encodeURIComponent(url)}`;
            break;
    }
    
    if (shareUrl) {
        window.open(shareUrl, '_blank');
    }
}

function copyLink() {
    navigator.clipboard.writeText(window.location.href).then(() => {
        showToast('Link copied to clipboard!');
    });
}
</script>
{% endblock %}
